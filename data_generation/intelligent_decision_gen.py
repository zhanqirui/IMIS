import csv
import random

def generate_intelligent_decisions(output_file):
    # 定义列名
    decision_columns = [
        "id",  # 主码
        "module_code",  # 模块代码，固定为 MSDATA
        "dept_id",  # 部门 ID，固定为 0000
        "medical_record_id",  # 病历 ID
        "medical_knowledge_id",  # 医疗知识 ID
        "integration_decision"  # 中西医融合智能决策方案
    ]

    # 病历 ID 范围
    medical_record_ids = [f"REC{i:06d}" for i in range(1, 1501)]

    # 医疗知识 ID 范围
    medical_knowledge_ids = [f"KNOW{i:06d}" for i in range(1, 100)]

    # 决策建议库（100条）
    decision_pool = [
        "建议患者采用中西医结合治疗方案，结合针灸与抗生素疗法。",
        "建议患者加强营养支持，同时采用抗炎药物治疗。",
        "建议患者通过中医理疗结合现代医学手术解决病症。",
        "采用中药调理与西医药物控制相结合的方式治疗。",
        "建议通过针灸缓解症状，配合使用镇痛药物。",
        "建议患者进行物理康复训练，结合药物治疗提升效果。",
        "建议患者通过现代影像检查明确病因后采用中药调理。",
        "推荐结合中医按摩和抗感染药物治疗方案。",
        "建议患者采用中药外敷，结合现代医学清创术。",
        "通过针灸调理经络，配合西药控制症状。",
        "建议患者进行心理干预，同时结合中西医治疗方案。",
        "采用中医艾灸疗法，结合抗菌药物控制感染。",
        "推荐患者尝试中医推拿治疗，同时配合物理治疗设备。",
        "建议患者服用中药汤剂，同时严格监测西药用量。",
        "采用针灸辅助镇痛，同时配合抗抑郁药物治疗。",
        "建议患者手术治疗后通过中药调理身体机能。",
        "推荐使用中医拔罐疗法，结合现代医疗手术处理病症。",
        "建议患者定期复查，通过中西医结合方式预防复发。",
        "采用中医经络疏通与西医抗生素联合治疗。",
        "建议患者结合运动康复训练与中药养生方案。",
        "推荐患者采用中西医结合方案，包括药物和针灸。",
        "采用中药熏蒸与物理康复治疗联合干预方式。",
        "建议患者通过中医食疗与现代医学营养补充治疗。",
        "通过针灸与抗病毒药物治疗联合减轻病情。",
        "推荐患者结合中药洗浴与现代药物治疗缓解症状。",
        "建议患者通过中医调理增强体质，配合药物治疗。",
        "采用中医外用药物与现代手术治疗联合方案。",
        "通过中医刮痧与抗炎药物治疗改善病症。",
        "建议患者服用中药丸剂，同时配合影像检查复查。",
        "采用针灸与现代康复设备治疗相结合的方法。",
        "通过中医药膳辅助治疗，同时坚持服用抗生素。",
        "建议患者通过中医艾灸与抗病毒药物治疗。",
        "采用中药内服与西药局部治疗联合方案。",
        "推荐患者使用中医推拿理疗，结合外科手术解决病症。",
        "建议患者通过中药治疗调节体内平衡，结合抗炎药物。",
        "采用针灸和抗焦虑药物相结合的治疗方法。",
        "建议患者通过中医药浴治疗，配合现代检查手段。",
        "采用中医理疗和抗感染药物的联合治疗方法。",
        "建议患者定期中药调理，同时坚持监测血压。",
        "通过中医气功与现代药物治疗联合方案改善健康。",
        "采用中医温针疗法，结合抗癌药物治疗方案。",
        "推荐患者通过中西医结合，采用内服与外敷方式治疗。",
        "建议患者通过中药煎服与现代治疗设备联合干预。",
        "采用中医经络调理与西医放疗相结合的治疗方法。",
        "通过针灸与抗生素的联合治疗方式缓解病情。",
        "推荐患者采用中西医综合治疗，包括心理干预与理疗。",
        "建议患者通过中药调理增强免疫力，同时手术治疗。",
        "采用中药熏洗与抗病毒药物的联合治疗方式。",
        "建议患者定期中医推拿，配合药物治疗减轻病痛。",
        "通过中医刮痧与现代手术治疗联合方式改善健康。",
        "推荐患者采用中药调理肠胃功能，结合抗生素治疗。",
        "采用针灸缓解病痛，同时配合抗抑郁药物治疗。",
        "建议患者通过中药治疗提升免疫功能，结合西药治疗。",
        "采用中医调理内分泌功能，结合现代影像检查。",
        "建议患者通过中西医结合方案进行术后康复治疗。",
        "采用中药饮片调理身体，结合物理治疗改善症状。",
        "通过中医药膏外敷与西医药物联合治疗。",
        "推荐患者尝试针灸辅助镇痛，结合药物治疗方案。",
        "建议患者通过中药调理胃肠功能，结合抗炎药物治疗。",
        "采用中医刮痧与现代药物治疗相结合的方法。",
        "建议患者通过中医推拿治疗，结合现代康复设备。",
        "推荐患者采用中药膏剂与手术治疗联合方案。",
        "采用中医针灸与现代药物治疗相结合的方法。",
        "建议患者通过中医熏蒸缓解症状，配合西医治疗。",
        "推荐患者通过中药丸剂与现代药物联合治疗方式。",
        "通过中医针灸与手术治疗相结合的方法改善病症。",
        "建议患者通过中药调节身体机能，结合药物治疗减轻症状。",
        "推荐患者采用中药洗浴疗法，结合现代药物治疗。",
        "通过针灸与抗焦虑药物的联合治疗方案改善病情。",
        "建议患者通过中药调理肝脏功能，结合现代检查手段。",
        "采用中医推拿与物理治疗设备结合的康复方案。",
        "建议患者通过中药调理身体功能，结合现代影像技术。",
        "通过中医拔罐与西医抗生素治疗联合方案缓解病情。",
        "推荐患者采用中医针灸与手术治疗结合的方法。",
        "建议患者通过中医药膳增强体质，配合药物治疗。",
        "通过中药汤剂调理身体，结合现代检查手段。",
        "推荐患者采用中医刮痧与抗生素治疗的联合方案。",
        "建议患者通过中医药膳辅助治疗，结合现代检查手段。",
        "采用中医药膳与心理干预的联合治疗方案改善病情。",
        "建议患者通过中药外敷治疗病症，结合药物治疗减轻症状。",
        "推荐患者尝试中药调理肠胃功能，结合手术治疗方法。",
        "采用中药调理身体机能，结合现代药物治疗方法。",
        "建议患者通过中药熏蒸治疗病症，结合西医药物治疗。",
        "通过中药调理血液循环，结合抗生素治疗缓解病情。",
        "推荐患者采用中医理疗与心理干预的综合治疗方案。",
        "建议患者通过中药调理身体机能，结合手术治疗减轻病情。",
        "采用中医药浴与抗炎药物结合的综合治疗方法。",
        "通过中药调理身体功能，结合现代检查手段改善病情。",
        "建议患者通过中药调理身体功能，结合西药治疗改善健康。",
        "采用中药调理身体机能，结合现代影像技术进行复查。",
        "通过中药治疗缓解病症，结合现代手术方式进行治疗。",
        "建议患者采用中医针灸与手术治疗相结合的方法改善病症。",
        "推荐患者通过中药熏蒸缓解症状，结合抗炎药物治疗。",
        "通过中医理疗缓解病症，结合现代药物治疗方式改善健康。",
        "建议患者通过中药调理身体机能，结合现代康复设备进行恢复。"
    ]

    # 写入智能决策到输出文件
    with open(output_file, mode="w", newline="", encoding="utf-8") as outfile:
        writer = csv.writer(outfile)
        writer.writerow(decision_columns)

        record_id = 1
        for medical_record_id in medical_record_ids:
            medical_knowledge_id = random.choice(medical_knowledge_ids)
            integration_decision = random.choice(decision_pool)

            row = [
                f"INTELLI{record_id:06d}",  # id
                "MSDATA",  # module_code
                "0000",  # dept_id
                medical_record_id,  # medical_record_id
                medical_knowledge_id,  # medical_knowledge_id
                integration_decision  # integration_decision
            ]
            writer.writerow(row)
            record_id += 1

# 文件路径
folder_path = 'E:/C_codes/IMIS/IMIS/data_generation/data/'
output_file = "intelligent_decision.data"

# 生成智能决策数据
generate_intelligent_decisions(folder_path+output_file)
print(f"智能决策数据已生成并保存至 {output_file}")
